---
title: jsæ‰‹å†™é¢˜
permalink: /pages/c68880/
categories:
  - jsæ‰‹å†™é¢˜
summary: æ‰‹å†™é¢˜
tags:
  - æ‰‹å†™ä¸“é¢˜
abbrlink: 53796
date: 2021-03-12 18:56:10
---


# JSæ‰‹å†™é¢˜

## ä¸€ã€JavaScriptåŸºç¡€

### 1.æ‰‹å†™Object.create

> æ€è·¯ ï¼š ä¼ å…¥ä¸€ä¸ªå¯¹è±¡ ä½œä¸ºè¿”å›å¯¹è±¡çš„åŸå‹
> ç›®çš„ ï¼š ä¸ºä¸€ä¸ªå¯¹è±¡æŒ‡å®šåŸå‹

```js
function create(obj) {
    function F() { };
    F.prototype = obj;
    return new F();
}
let obj = {a: 1 , b: 2};
let obj1 = create(obj);
console.log(obj1.__proto__);//{a: 1 , b: 2}
//æ€è·¯ ï¼š ä¼ å…¥ä¸€ä¸ªå¯¹è±¡ ä½œä¸ºè¿”å›å¯¹è±¡çš„åŸå‹
//ç›®çš„ ï¼š ä¸ºä¸€ä¸ªå¯¹è±¡æŒ‡å®šåŸå‹
```

### 2.æ‰‹å†™instanceofæ–¹æ³•

> ç›®çš„ï¼šåˆ¤æ–­æ„é€ å‡½æ•°çš„åŸå‹æ˜¯å¦å‡ºç°åœ¨å¯¹è±¡çš„åŸå‹é“¾ä¸Š
>
> æ€è·¯ï¼šâ‘ è·å–æ„é€ å‡½æ•°åŸå‹
>
> â€‹            â‘¡è·å–å¯¹è±¡çš„åŸå‹
>
> â€‹			â‘¢å¾ªç¯åˆ¤æ–­å¯¹è±¡çš„åŸå‹æ˜¯å¦ç­‰äºæ„é€ å‡½æ•°çš„åŸå‹ï¼ŒçŸ¥é“å¯¹è±¡åŸå‹ä¸ºnullï¼ŒåŸå‹é“¾æœ€ç»ˆä¸ºnull

å…·ä½“å®ç°ï¼š

```js
function myinstanceof(obj, F) {
    let objProto = Object.getPrototypeOf(obj);//è·å–å¯¹è±¡objçš„åŸå‹
    let fProto = F.prototype;//è·å–æ„é€ å‡½æ•°çš„åŸå‹
    while (true) {
        if (!objProto) return false;//å¦‚æœéå†åˆ°åŸå‹å¯¹è±¡ä¸ºnull åˆ™è¡¨ç¤ºæ‰¾ä¸åˆ°
        if (objProto === fProto) return true;//å½“å‰å¯¹è±¡åŸå‹===æ„é€ å‡½æ•°åŸå‹ åˆ™è¡¨ç¤ºæ‰¾åˆ°
        objProto = Object.getPrototypeOf(objProto);//è·å–å¯¹è±¡åŸå‹çš„åŸå‹ï¼Œå¾ªç¯å‘ä¸Šå¯»æ‰¾
    }
}
//æµ‹è¯•
function F() {
}
let obj = new F();
console.log(myinstanceof(obj, F));//true
```

### 3.æ‰‹å†™newæ“ä½œç¬¦

> æ€è·¯ï¼šâ‘ åˆ›å»ºä¸€ä¸ªç©ºå¯¹è±¡
>
> â€‹			â‘¡å°†å®ä¾‹å¯¹è±¡çš„åŸå‹æŒ‡å‘æ„é€ å‡½æ•°çš„prototypeå¯¹è±¡
>
> â€‹			â‘¢æ„é€ å‡½æ•°çš„thisæŒ‡å‘å®ä¾‹å¯¹è±¡ï¼Œå¹¶è°ƒç”¨æ„é€ å‡½æ•°
>
> â€‹			â‘£åˆ¤æ–­å‡½æ•°çš„è¿”å›å€¼ï¼Œå¦‚æœæ˜¯å€¼ç±»å‹ï¼Œè¿”å›åˆ›å»ºçš„å¯¹è±¡ã€‚å¦‚æœæ˜¯å¼•ç”¨ç±»å‹ï¼Œå°±è¿”å›è¿™ä¸ªå¼•ç”¨ç±»å‹çš„å¯¹è±¡ã€‚

```js
function _new(Fn, ...args) {
    let obj = {};//1ã€åˆ›å»ºä¸€ä¸ªç©ºå¯¹è±¡
    obj.__proto__ = Fn.prototype;//2ã€å®ä¾‹å¯¹è±¡çš„åŸå‹æŒ‡å‘æ„é€ å‡½æ•°Fnçš„prototypeå¯¹è±¡
    let res = Fn.call(obj, ...args);//3ã€æ„é€ å‡½æ•°Fnç»‘å®šthisæŒ‡å‘objå®ä¾‹ï¼Œå¹¶è°ƒç”¨æ„é€ å‡½æ•° è¿”å›å¯¹è±¡res
    return typeof res === 'object' ? res : obj;//åˆ¤æ–­resçš„ç±»å‹ å¦‚æœæ˜¯å¯¹è±¡åˆ™è¿”å›res ä¸æ˜¯åˆ™è¿”å›æ–°åˆ›å»ºçš„objå¯¹è±¡å®ä¾‹
}
function Person(name, age) {
    this.name = name;
    this.age = age;
    // return {
    //     name: name,
    //     age: age
    // }
}
//æµ‹è¯•
let personImpl = _new(Person, 'guang', '28');
console.log(personImpl);
//returnæ²¡æ³¨é‡Š     æ‰“å°{ name: 'guang', age: '28' }
//returnè¯­å¥æ³¨é‡Š   æ‰“å°Person { name: 'guang', age: '28' }
```

### 4.æ‰‹å†™Promise.all()

> æ€è·¯ï¼šPromise.all( )æ–¹æ³•æ¥æ”¶ä¸€ä¸ªpromiseå¯è¿­ä»£å¯¹è±¡ï¼Œå¹¶åªè¿”å›ä¸€ä¸ªæ–°çš„Promiseå®ä¾‹ï¼Œæ‰€æœ‰è¾“å…¥çš„promiseçš„resolveå›è°ƒçš„ç»“æœæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œè¿”å›å€¼æ•°ç»„ä¸å‚æ•°é¡ºåºä¸€è‡´ã€‚åªè¦æœ‰ä¸€ä¸ªpromiseçš„å›è°ƒç»“æœæ˜¯rejectï¼Œç›´æ¥è¿”å›ç¬¬ä¸€ä¸ªrejectã€‚ç®€å•æ¥è¯´å°±æ˜¯å¤šä¸ªpromiseå®ä¾‹åŒ…è£…æˆä¸€ä¸ªæ–°çš„promiseå®ä¾‹
>
> ä¿®æ”¹======æ¥æ”¶ä¸€ä¸ªpromiseå¯è¿­ä»£å¯¹è±¡ï¼Œå¹¶è¿”å›ä¸€ä¸ªæ–°çš„Promiseå®ä¾‹(ä¸€ä¸ªæ•°ç»„)ã€‚å½“æ‰€æœ‰promiseéƒ½ä¸ºresolveæˆåŠŸæ—¶ æ‰è¿”å›æˆåŠŸï¼Œä½†æ˜¯åªè¦æœ‰ä¸€ä¸ªå¤±è´¥é‚£ä¹ˆå°±è¿”å›ç¬¬ä¸€ä¸ªå¤±è´¥çš„

**åº”ç”¨åœºæ™¯**ï¼š`Promise.all( ).then( )`é€‚ç”¨äºå¤„ç†å¤šä¸ªå¼‚æ­¥ä»»åŠ¡ï¼Œä¸”æ‰€æœ‰çš„å¼‚æ­¥ä»»åŠ¡éƒ½å¾—åˆ°ç»“æœæ—¶çš„æƒ…å†µã€‚

å¦‚ï¼šç”¨æˆ·ç‚¹å‡»æŒ‰é’®ï¼Œä¼šå¼¹å‡ºä¸€ä¸ªå¼¹å‡ºå¯¹è¯æ¡†ï¼Œå¯¹è¯æ¡†ä¸­æœ‰ä¸¤éƒ¨åˆ†æ•°æ®å‘ˆç°ï¼Œè¿™ä¸¤éƒ¨åˆ†æ•°æ®åˆ†åˆ«æ˜¯ä¸åŒçš„åç«¯æ¥å£è·å–çš„æ•°æ®ã€‚

å¼¹æ¡†å¼¹å‡ºåçš„åˆå§‹æƒ…å†µä¸‹ï¼Œå°±è®©è¿™ä¸ªå¼¹å‡ºæ¡†å¤„äºæ•°æ®åŠ è½½çš„çŠ¶æ€ï¼Œå½“è¿™ä¸¤éƒ¨åˆ†æ•°æ®éƒ½ä»æ¥å£è·å–åˆ°çš„æ—¶å€™ï¼Œæ‰è®©è¿™ä¸ªæ•°æ®åŠ è½½çŠ¶æ€æ¶ˆå¤±ã€‚è®©ç”¨æˆ·çœ‹åˆ°è¿™ä¸¤éƒ¨åˆ†çš„æ•°æ®ã€‚

é‚£ä¹ˆæ­¤æ—¶ï¼Œæˆ‘ä»¬å°±éœ€æ±‚è¿™ä¸¤ä¸ªå¼‚æ­¥æ¥å£è¯·æ±‚ä»»åŠ¡éƒ½å®Œæˆçš„æ—¶å€™åšå¤„ç†ï¼Œæ‰€ä»¥æ­¤æ—¶ï¼Œä½¿ç”¨Promise.allæ–¹æ³•ï¼Œå°±å¯ä»¥è½»æ¾çš„å®ç°ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ä»£ç å†™æ³•

```js
function myPromiseAll(promises) {// æ¥æ”¶ä¸€ä¸ªPromiseçš„å¯è¿­ä»£å¯¹è±¡Arrayï¼ŒMapï¼ŒSet
    return new Promise((resolve, reject) => {// è¿”å›ä¸€ä¸ªPromiseå®ä¾‹
        if (!Array.isArray(promises)) {
            return new TypeError('arguments must be an array');// åˆ¤æ–­æ˜¯å¦ä¸ºä¸€ä¸ªæ•°ç»„ ä¸æ˜¯åˆ™æŠ›å‡ºç±»å‹å¼‚å¸¸
        }
        let count = 0;// è®¾ç½®è®¡æ•°å™¨ è®¡ç®—è¢«è§£å†³çš„æœŸçº¦Promiseä¸ªæ•°
        let result = [];// å®šä¹‰ä¸€ä¸ªæ•°ç»„ä¿å­˜æ‰€æœ‰è¢«è§£å†³çš„æœŸçº¦Promise
        let n = promises.length;// è·å–å¯è¿­ä»£å¯¹è±¡çš„é•¿åº¦ï¼ˆç®—æ˜¯ä¸€ç§å°ä¼˜åŒ–å§ï¼‰
        for (let i = 0; i < n; i++) {// éå†æ‰€æœ‰å‚æ•°ï¼Œå¹¶å‘æ‰§è¡Œæ¯ä¸€ä¸ªpromise
            Promise.resolve(promises[i]).then(res => {
                result[i] = res;// å°†æ¯ä¸€ä¸ªpromiseçš„resolveå›è°ƒç»“æœä¸¢è¿›resultæ•°ç»„
                count++;// æ¯å¾ªç¯ä¸€æ¬¡è®¡æ•°å™¨åŠ ä¸€
                if (count === promises.length) {// è®¡æ•°å™¨ç­‰äºæ•°ç»„é•¿åº¦ åˆ™è¿”å›ç»“æœæ•°ç»„result
                    resolve(result);
                }
            }).catch(err => reject(err));// æ•è·reject,catchä¸ä»…å¯ä»¥æ•è·rejectæ—¶çš„çŠ¶æ€ åŒæ—¶èƒ½å¤Ÿæ•è·thenå›è°ƒä¸­çš„é”™è¯¯
        }
    })
}
// æµ‹è¯•
let p1 = Promise.resolve(1);
let p2 = Promise.resolve(2);
let p3 = Promise.resolve(3);
myPromiseAll([p3, p1, p2]).then(res => {
    console.log(res) // [3, 1, 2]
})
Promise.all([p3, p1, p2]).then(res => {
    console.log(res);// [3, 1, 2]
})
```

> å¯¹é¡ºåºçš„ä¸€ä¸ªè§£æƒ‘ï¼Œthené‡Œçš„ å‡½æ•°å†…éƒ¨å¼•ç”¨äº†å¤–éƒ¨çš„äº§é‡i å› æ­¤å¤–éƒ¨çš„å˜é‡i ä¸ä¼šè¢«é‡Šæ”¾ã€‚å½“å¼‚æ­¥onfullfilledå‡½æ•°æ‰§è¡Œæ—¶ï¼Œå†…éƒ¨å¼•ç”¨çš„æ€»æ˜¯ä¹‹å‰çš„é‚£ä¸ªi ï¼Œå› æ­¤ä¿è¯äº†é¡ºåºçš„å‡†ç¡®æ€§ã€‚

### 5.æ‰‹å†™Promise.race()

> Promise.race() æ¥æ”¶ä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡ï¼Œè¿”å›ä¸€ä¸ªåŒ…è£…æœŸçº¦ï¼Œæ˜¯ä¸€ç»„é›†åˆä¸­æœ€å…ˆè§£å†³æˆ–æ‹’ç»çš„æœŸçº¦çš„é•œåƒã€‚

```js
Promise.race = function (args) {//ä¼ å…¥å¯è¿­ä»£å¯¹è±¡args
  return new Promise((resolve, reject) => {//è¿”å›ä¸€ä¸ªpromiseå®ä¾‹ï¼ˆåŒ…è£…æœŸçº¦ï¼‰
    for (let i = 0, len = args.length; i < len; i++) {
      args[i].then(resolve, reject)// Promise.then()å‡½æ•°æœ€å¤šæ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œåˆ†åˆ«è¿›å…¥å…‘ç°å’Œæ‹’ç»çŠ¶æ€æ—¶æ‰§è¡Œï¼Œæ‰§è¡ŒæŸä¸€ä¸ªå°±ç›´æ¥è¿”å›å½“å‰çŠ¶æ€çš„æœŸçº¦
    }
  })
}
```

**4ï¼Œ5 æ€»ç»“**

- Promise.allæ¥æ”¶çš„æ˜¯æ•°ç»„ï¼Œå¾—åˆ°çš„ç»“æœä¹Ÿæ˜¯æ•°ç»„ï¼Œå¹¶ä¸”ä¸€ä¸€å¯¹åº”ï¼Œä¹Ÿå¯ä»¥ç†è§£ä¸ºPromise.allç…§é¡¾è·‘çš„æœ€æ…¢çš„ï¼Œæœ€æ…¢çš„è·‘å®Œæ‰ç»“æŸã€‚
- Promise.raceæ¥æ”¶çš„ä¹Ÿæ˜¯æ•°ç»„ï¼Œä¸è¿‡ï¼Œå¾—åˆ°çš„å´æ˜¯æ•°ç»„ä¸­è·‘çš„æœ€å¿«çš„é‚£ä¸ªï¼Œå½“æœ€å¿«çš„ä¸€è·‘å®Œå°±ç«‹é©¬ç»“æŸã€‚

ğŸ¨ç”¨ä¸€å¥è¯æ€»ç»“é˜²æŠ–å’ŒèŠ‚æµçš„åŒºåˆ«ï¼š**é˜²æŠ–æ˜¯å°†è§„å®šæ—¶é—´å†…å¤šæ¬¡æ‰§è¡Œå˜ä¸ºæœ€åä¸€æ¬¡æ‰§è¡Œï¼ŒèŠ‚æµæ˜¯è§„å®šæ—¶é—´å†…å°†å¤šæ¬¡æ‰§è¡Œå˜ä¸ºæ¯éš”ä¸€æ®µæ—¶é—´æ‰§è¡Œ**

### 6.æ‰‹å†™å‡½æ•°é˜²æŠ–

> å‡½æ•°é˜²æŠ–æ˜¯æŒ‡åœ¨äº‹ä»¶è¢«è§¦å‘ n ç§’åå†æ‰§è¡Œå›è°ƒï¼Œå¦‚æœåœ¨è¿™ n ç§’å†…äº‹ä»¶åˆè¢«è§¦å‘ï¼Œåˆ™**é‡æ–°è®¡æ—¶**ï¼Œä¹Ÿå°±æ˜¯è¯´äº‹ä»¶åœ¨è§„å®šäº‹ä»¶å†…é‡æ–°è§¦å‘åªæ‰§è¡Œæœ€åä¸€æ¬¡ã€‚ä¸»è¦æ˜¯åˆ©ç”¨é—­åŒ…ä¿å­˜ä¸€ä¸ªtimerè®¡æ—¶å™¨ï¼Œè¿™å¯ä»¥ä½¿ç”¨åœ¨ä¸€äº›ç‚¹å‡»è¯·æ±‚çš„äº‹ä»¶ä¸Šï¼Œé¿å…å› ä¸ºç”¨æˆ·çš„å¤šæ¬¡ç‚¹å‡»å‘åç«¯å‘é€å¤šæ¬¡è¯·æ±‚ã€‚

**åœºæ™¯ï¼šinputäº‹ä»¶æ¨¡ç³ŠæŸ¥è¯¢**

> inputè¾“å…¥æ¡†çš„inputäº‹ä»¶ä¼šåœ¨è¾“å…¥æ¡†å†…å®¹å‘ç”Ÿæ”¹å˜çš„æ—¶å€™æ‰§è¡Œï¼Œé‚£ä¹ˆå°±å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼šæ¯æ¬¡è¾“å…¥ï¼Œéƒ½ä¼šè§¦å‘inputäº‹ä»¶ï¼Œæ‰§è¡Œå‡½æ•°ï¼Œæˆ–è€…æ¥å£è¯·æ±‚ï¼Œè€Œè¿™å¹¶ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ï¼šæ¯”å¦‚ï¼Œä½ æƒ³è¦æ¨¡ç³ŠæŸ¥è¯¢ "liu" ç›¸å…³çš„æ‰€æœ‰æ•°æ®ï¼Œè€Œå½“ä½ åœ¨inputæ¡†ä¸­è¾“å…¥ "l" çš„æ—¶å€™å°±å·²ç»è§¦å‘äº†inputäº‹ä»¶ï¼Œå»è¯·æ±‚äº†æ¥å£ï¼Œè€Œè¿™å¹¶ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬çš„é˜²æŠ–å‡½æ•°å°±ç™»åœºäº†ï¼›

```js
// äº‹ä»¶åœ¨è§„å®šæ—¶é—´å†…é‡å¤è§¦å‘åªæ‰§è¡Œä¸€æ¬¡
function debounce(fn, time, immediate) {//fnä¸ºå›è°ƒå‡½æ•°(éœ€è¦é˜²æŠ–çš„å‡½æ•°)ï¼Œtimeæ˜¯è‡ªå®šä¹‰é—´éš”æ—¶é—´ debounceæ˜¯å¯¹éœ€è¦é˜²æŠ–çš„å‡½æ•°çš„å°è£…
    let timer = null;
    return function (...args) {
        // æ·»åŠ ä¸€ä¸ªç«‹å³æ‰§è¡ŒåŠŸèƒ½
        if (immediate && !timer) {
            fn.apply(this, args);
        }
        timer && clearTimeout(timer);//timerä¸ºtrueåˆ™è¡¨ç¤ºæœ‰æ–°çš„è§¦å‘ éœ€è¦æŠŠä¹‹å‰çš„setTimeoutè®¡æ—¶å™¨æ¸…é™¤å†é‡æ–°è®¡æ—¶
        // let args = arguments;//ä¸åŒå‡½æ•°å¯èƒ½ä¼šæœ‰ä¸åŒçš„å‚æ•°ä¼ å…¥ è¿™é‡Œä½¿ç”¨argsæ¥æ”¶argumentsæ˜¯ä¸ºäº†é¿å…ä¸‹é¢ç›´æ¥ä½¿ç”¨äº†setTimeoutå‡½æ•°çš„arguments
        timer = setTimeout(() => {
            fn.apply(this, args);//éœ€è¦applyç»‘å®šthiså¹¶è°ƒç”¨ä¼ è¿›æ¥çš„åŸå‡½æ•° ï¼Ÿï¼Ÿç–‘é—®ï¼šä¸ºä»€ä¹ˆè¦ç»‘å®šthis----thisæŒ‡å‘å®¹å™¨
        }, time)
    }
}
let addBtn = document.getElementById('add')
function addOne() {
    console.log('å¢åŠ ä¸€ä¸ª')
}
addBtn.addEventListener('click', debounce(addOne))//æ·»åŠ clickç‚¹å‡»äº‹ä»¶ï¼Œå¯¹addOneå®ç°é˜²æŠ–
// å®ç°æ€è·¯ï¼š
// 1åˆ©ç”¨é—­åŒ…ä¿å­˜ä¸€ä¸ªtimerï¼Œç„¶åè¿”å›ä¸€ä¸ªå‡½æ•°ï¼ˆè¯¥å‡½æ•°å°±æ˜¯åç»­é¢‘ç¹è§¦å‘æ“ä½œæ—¶è°ƒç”¨çš„å‡½æ•°ï¼‰
// 2æ ¹æ®æ ‡è¯†ä½åˆ¤æ–­æ˜¯å¦ç¬¬ä¸€æ¬¡éœ€è¦æ‰§è¡Œï¼ˆæœ‰äº›æ—¶å€™éœ€è¦é¦–æ¬¡è°ƒç”¨å‡½æ•°ç«‹å³æ‰§è¡Œçš„ï¼‰
// 3å½“æœ‰æ–°çš„äº‹ä»¶è§¦å‘ï¼Œè‹¥å­˜åœ¨å®šæ—¶å™¨ï¼Œåˆ™æ¸…ç©ºå®šæ—¶å™¨
// 4è®¾ç½®ä¸€ä¸ªæ–°çš„å®šæ—¶å™¨é‡æ–°è®¡æ—¶
```

### 7.æ‰‹å†™å‡½æ•°èŠ‚æµ

> å‡½æ•°èŠ‚æµæ˜¯æŒ‡å•ä½æ—¶é—´å†…ï¼Œåªèƒ½æœ‰ä¸€æ¬¡è§¦å‘äº‹ä»¶çš„å›è°ƒå‡½æ•°æ‰§è¡Œï¼ŒèŠ‚æµå¯ä»¥ä½¿ç”¨åœ¨ scroll å‡½æ•°çš„äº‹ä»¶ç›‘å¬ä¸Šï¼Œé€šè¿‡äº‹ä»¶èŠ‚æµæ¥é™ä½äº‹ä»¶è°ƒç”¨çš„é¢‘ç‡ã€‚å¦‚ï¼›å®ç°ä¸€ä¸ªé¼ æ ‡æ»šåŠ¨æ‰“å°äº‹ä»¶ï¼Œ**æƒ³è®©å®ƒåœ¨3så†…åªæ‰§è¡Œä¸€æ¬¡**

**åœºæ™¯ï¼šç‚¹å‡»æŒ‰é’®é‡å¤å‘é€è¯·æ±‚ï¼š(èŠ‚æµ)**

é¡¹ç›®ä¸­ç‚¹å‡»åˆ›å»ºã€ç¼–è¾‘ã€åˆ é™¤ç­‰æŒ‰é’®éƒ½ä¼šå‘é€httpè¯·æ±‚ï¼Œç½‘ç»œå¡é¡¿çš„æƒ…å†µä¸‹ç‚¹å‡»æŒ‰é’®ä¹‹åä¸èƒ½å¿«é€Ÿçš„å“åº”ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ç”¨æˆ·ä¼šé‡å¤ç‚¹å‡»æŒ‰é’®ï¼Œæ‰€ä»¥ä¼šé€ æˆ**é‡å¤å‘é€è¯·æ±‚**é—®é¢˜ï¼Œä¸€å®šé‡é€ æˆå¡é¡¿å»¶è¿Ÿé—®é¢˜ï¼Œè¿™ä¸ªæ—¶å€™ä¾¿å¯ä»¥é‡‡ç”¨**èŠ‚æµ**

```js
// æ—¶é—´æˆ³ç‰ˆæœ¬
// ä¸»è¦æ˜¯åˆ©ç”¨é—­åŒ…ä¿å­˜ä¸Šä¸€æ¬¡çš„æ—¶é—´preTime
function throttle(fn, time) {
    let preTime = 0;//ç¬¬ä¸€æ¬¡æ˜¯è®°å½•åˆå§‹æ—¶é—´ æ¥ä¸‹æ¥è®°å½•ä¸Šä¸€æ¬¡æ—¶é—´
    return function (...args) {
        let curTime = Date.now()//è·å–å½“å‰æ—¶é—´
        if (curTime - preTime >= time) {//å¦‚æœä¸¤æ¬¡æ—¶é—´é—´éš”è¶…å‡ºæŒ‡å®šæ—¶é—´é—´éš”time åˆ™å¯ä»¥æ‰§è¡Œå‡½æ•°fn
            fn.apply(this, args);
            preTime = curTime;//æ›´æ–°ä¸Šä¸€æ¬¡çš„æ—¶é—´ä¸ºå½“å‰æ—¶é—´
        }
    }
  }
function scrollTest(){
    console.log('ç°åœ¨æˆ‘è§¦å‘äº†')
  }
document.addEventListener('scroll',throttle(scrollTest,time)) //å¯¹é¼ æ ‡æ»šåŠ¨äº‹ä»¶è¿›è¡Œå‡½æ•°èŠ‚æµ

// å®šæ—¶å™¨ç‰ˆæœ¬
// åˆ©ç”¨é—­åŒ…ä¿å­˜å®šæ—¶å™¨timerï¼Œäº‹ä»¶è§¦å‘åç»è¿‡timeæ—¶é—´åˆ™æ‰§è¡Œå‡½æ•°
function throttle(fn, time) { 
  let timer = null;// åˆ›å»ºå®šæ—¶å™¨
  return function (... args) {
    if (!timer) {// å®šæ—¶å™¨ä¸å­˜åœ¨
      timer = setTimeout(() => {
        fn.apply(this, args);
        timer = null;
      }, time)
    }
  }
}
```

### 8.å‡½æ•°æŸ¯é‡ŒåŒ–å®ç°

> å‡½æ•°æŸ¯é‡ŒåŒ–æŒ‡çš„æ˜¯å°†æ¥æ”¶**å¤šä¸ªå‚æ•°**çš„**ä¸€ä¸ªå‡½æ•°**è½¬æ¢æˆä¸€ç³»åˆ—æ¥æ”¶**ä¸€ä¸ªå‚æ•°**çš„**å‡½æ•°**ã€‚ä¸»è¦ä½¿ç”¨é—­åŒ…å’Œé€’å½’å®ç°
>
> ä»¥ä¸‹ä¸¤ç§æ–¹å¼å®ç°æŸ¯é‡ŒåŒ–

#### 8.1æ™®é€šé€’å½’å®ç°

```js
function toCurry(fn, args) {// fnä¸ºéœ€è¦æŸ¯é‡ŒåŒ–çš„å‡½æ•°
    var length = fn.length;// åŸå‡½æ•°å‚æ•°ä¸ªæ•°
    var args = args || []; 
    return function(){
        // 
        newArgs = args.concat(Array.prototype.slice.call(arguments));
        if (newArgs.length < length) {// æ”¶é›†çš„å‚æ•°æ¯”åŸå‡½æ•°æ‰€éœ€å‚æ•°å°‘ å°±ç»§ç»­æŸ¯é‡ŒåŒ–
            return toCurry.call(this,fn,newArgs);
        }else{
            return fn.apply(this,newArgs);
        }
    }
}
// æµ‹è¯•
function multiFn(a, b, c) {
    return a * b * c;
}
var multi = toCurry(multiFn);
console.log(multi(2)(3)(4));
console.log(multi(2, 3, 4));
console.log(multi(2)(3, 4));
console.log(multi(2, 3)(4));
```

#### 8.2 ES6ç®­å¤´å‡½æ•°é€’å½’å®ç°

```js
function toCurry(fn, ...args) {
    if (args.length >= fn.length) {
        return fn(...args);
    } else {
        return (...args2) => toCurry(fn, ...args, ...args2);
    }
}
// æµ‹è¯•
function multiFn(a, b, c) {
    return a * b * c;
}
var multi = toCurry(multiFn);
console.log(multi(2)(3)(4));
console.log(multi(2, 3, 4));
console.log(multi(2)(3, 4));
console.log(multi(2, 3)(4));
```



### æ·±æµ…æ‹·è´çš„å‰ç½®çŸ¥è¯†

å‰ç½®çŸ¥è¯†ï¼š

> **åŸºæœ¬æ•°æ®ç±»å‹**ï¼šå­˜åœ¨æ ˆä¸­ï¼Œ**å˜é‡å+å€¼**ï¼›å¤åˆ¶æ—¶ç³»ç»Ÿä¼šè‡ªåŠ¨ä¸ºæ–°çš„å˜é‡åœ¨æ ˆå†…å­˜ä¸­åˆ†é…ä¸€ä¸ªæ–°å€¼ï¼Œæ—§å€¼ä¸ä¼šè¢«æ”¹å˜

```js
let number1 = 1;
let number2 = 2;
console.log(number1, number2); // 1 2
number2 = number1;
number2 = 3
console.log(number1, number2); // 1 3
```

> å¼•ç”¨æ•°æ®ç±»å‹ï¼šå­˜åœ¨å †ä¸­ï¼Œæ ˆä¸­å­˜å‚¨**å˜é‡å+åœ°å€**ï¼Œåœ°å€æŒ‡å‘å †ä¸­çš„æ•°æ®ï¼›å¤åˆ¶æ—¶ç³»ç»ŸåŒæ ·ä¸ºæ–°çš„å˜é‡åˆ†é…ä¸€ä¸ªå€¼ï¼Œåªæ˜¯è¿™ä¸ªå€¼æ˜¯æŒ‡å‘é˜Ÿä¸­å¯¹è±¡çš„ä¸€ä¸ªåœ°å€ï¼Œå› æ­¤å¯¹å…¶è¿›è¡Œä¿®æ”¹ä¼šå¯¼è‡´åŒä¸€ä¸ªå †ä¸­å¯¹è±¡çš„ä¿®æ”¹

```js
let obj1 = {
    name: 'guang',
};
let obj2 = obj1;
console.log(obj1); // { name: 'guang' }
console.log(obj2); // { name: 'guang' }
obj2.name = 'me';
console.log(obj1); // { name: 'me' }
console.log(obj2); // { name: 'me' }
// å¤åˆ¶å¼•ç”¨æ•°æ®ç±»å‹ï¼Œå¹¶è¿›è¡Œä¿®æ”¹ï¼Œä¼šæ”¹å˜åŸæœ¬çš„å€¼
```

### 9.æ‰‹å†™æµ…æ‹·è´

**æµ…æ‹·è´**ï¼šæŒ‡çš„æ˜¯å°†ä¸€ä¸ª**å¯¹è±¡çš„å±æ€§å€¼**å¤åˆ¶åˆ°å¦ä¸€ä¸ªå¯¹è±¡ï¼Œå¦‚æœæœ‰çš„å±æ€§çš„å€¼ä¸ºå¼•ç”¨ç±»å‹çš„è¯ï¼Œé‚£ä¹ˆä¼šå°†è¿™ä¸ªå¼•ç”¨çš„åœ°å€å¤åˆ¶ç»™å¯¹è±¡ï¼Œå› æ­¤ä¸¤ä¸ªå¯¹è±¡ä¼šæœ‰åŒä¸€ä¸ªå¼•ç”¨ç±»å‹çš„å¼•ç”¨ã€‚æµ…æ‹·è´å¯ä»¥ä½¿ç”¨  Object.assign å’Œå±•å¼€è¿ç®—ç¬¦ï¼Œè¿˜æœ‰æ•°ç»„API(concatã€sliceæ–¹æ³•ç­‰)æ¥å®ç°ã€‚

> `Object.assign `  ç”¨äºæ‹·è´å¯¹è±¡ï¼Œå®ƒå¯¹äºç¬¬ä¸€å±‚æ¥è¯´ï¼Œæ˜¯å®Œå…¨æ‹·è´ï¼›å¯¹äºç¬¬äºŒå±‚åŠä»¥ä¸Šæ¥è¯´ï¼Œæ˜¯ç®€å•å¤åˆ¶ã€‚
>
> `Array.prototype.concat(target)`ï¼š`concat()` æ˜¯æ•°ç»„çš„ä¸€ä¸ªå†…ç½®æ–¹æ³•ï¼Œç”¨äºåˆå¹¶ä¸¤ä¸ªæˆ–è€…å¤šä¸ªæ•°ç»„ã€‚è¿™ä¸ªæ–¹æ³•ä¸ä¼šæ”¹å˜ç°æœ‰æ•°ç»„ï¼Œè€Œæ˜¯è¿”å›ä¸€ä¸ªæ–°æ•°ç»„ã€‚`const b = [].concat(a)`
>
> `Array.prototype.slice(start, end)`ï¼š`slice()` ä¹Ÿæ˜¯æ•°ç»„çš„ä¸€ä¸ªå†…ç½®æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¼šè¿”å›ä¸€ä¸ªæ–°çš„å¯¹è±¡ã€‚`slice()` ä¸ä¼šæ”¹å˜åŸæ•°ç»„ã€‚`const b = a.slice()`
>
> **å±•å¼€è¿ç®—ç¬¦**ï¼š`[...arr]` å¯ä»¥å¾—åˆ°ä¸€ä¸ªæµ…æ‹·è´æ–°æ•°ç»„ã€‚

```js
// æµ…æ‹·è´çš„å®ç°
function shallowCopy(obj) {
    if (!obj || typeof obj !== "object") return;// ç©ºå¯¹è±¡å’Œéå¯¹è±¡ç±»å‹ ç›´æ¥è¿”å›
    let newObj = Array.isArray(obj) ? [] : {};// æ ¹æ® obj çš„ç±»å‹åˆ¤æ–­æ˜¯æ–°å»ºä¸€ä¸ªæ•°ç»„è¿˜æ˜¯å¯¹è±¡
    //for...inè¯­å¥ä»¥ä»»æ„é¡ºåºè¿­ä»£å¯¹è±¡çš„å¯æšä¸¾å±æ€§(åŒ…æ‹¬å®ƒçš„åŸå‹é“¾ä¸Šçš„å¯æšä¸¾å±æ€§)ã€‚----for...of è¯­å¥éå†å¯è¿­ä»£å¯¹è±¡å®šä¹‰è¦è¿­ä»£çš„æ•°æ®ã€‚
    for (let key in obj) {// éå† objï¼Œå¹¶ä¸”åˆ¤æ–­æ˜¯ obj è‡ªèº«çš„å±æ€§æ‰æ‹·è´
        if (obj.hasOwnProperty(key)) {
            newObj[key] = obj[key];
        }
    }
    return newObj;
}//ä¿®æ”¹èµ‹å€¼åçš„å¯¹è±¡Bçš„éå¯¹è±¡å±æ€§ï¼Œä¸ä¼šå½±å“åŸå¯¹è±¡Açš„éå¯¹è±¡å±æ€§ï¼›ä¿®æ”¹èµ‹å€¼åçš„å¯¹è±¡Bçš„å¯¹è±¡å±æ€§ï¼Œå´ä¼šå½±å“åŸå¯¹è±¡Açš„å¯¹è±¡å±æ€§ã€‚
```

**ç›´æ¥èµ‹å€¼å’Œæµ…æ‹·è´çš„åŒºåˆ«**ï¼šéå¯¹è±¡å±æ€§æ„æ€æ˜¯å±æ€§å¯¹åº”çš„å€¼ä¸æ˜¯ä¸€ä¸ªå¯¹è±¡

- ç›´æ¥èµ‹å€¼ï¼šæ— è®ºä¿®æ”¹èµ‹å€¼åçš„å¯¹è±¡çš„**éå¯¹è±¡å±æ€§**è¿˜æ˜¯**å¯¹è±¡å±æ€§**ï¼Œéƒ½ä¼šå½±å“åŸå¯¹è±¡Açš„å¯¹åº”çš„å±æ€§

- æµ…æ‹·è´ï¼šä¿®æ”¹**æ‹·è´å**çš„å¯¹è±¡çš„**éå¯¹è±¡å±æ€§**ï¼Œä¸ä¼šå½±å“åŸå¯¹è±¡çš„**éå¯¹è±¡å±æ€§**ï¼›ä¿®æ”¹**æ‹·è´å**çš„å¯¹è±¡çš„**å¯¹è±¡å±æ€§**ï¼Œå´ä¼šå½±å“åŸå¯¹è±¡çš„**å¯¹è±¡å±æ€§**ã€‚å› ä¸ºå¯¹è±¡å±æ€§æ‹·è´çš„æ˜¯å¼•ç”¨åœ°å€

### 10.æ‰‹å†™æ·±æ‹·è´

æ·±æ‹·è´ä¼šå¦å¤–åœ¨å †ç©ºé—´ä¸­æ‹·è´ä¸€ä»½ä¸€æ¨¡ä¸€æ ·çš„å¯¹è±¡ï¼Œæ–°å¯¹è±¡è·ŸåŸå¯¹è±¡ä¸å…±äº«å†…å­˜ï¼Œä¿®æ”¹æ‹·è´åçš„å¯¹è±¡ä¸ä¼šæ”¹åˆ°åŸå¯¹è±¡ã€‚äºŒè€…æŒ‡å‘ä¸åŒçš„å¯¹è±¡ï¼Œåœ°å€ç©ºé—´å®Œå…¨ä¸ä¸€æ ·

**æ–¹æ³•ä¸€ï¼š**åˆ©ç”¨ JSON å¯¹è±¡ä¸­çš„ parse å’Œ stringifyï¼›

```js
var obj1 = {
    name: "cat",
    show:function(){
        console.log(this.name);
    }
};
var obj2 = JSON.parse(JSON.stringify(obj1));
obj2.name = "pig";
console.log(obj1.name); //cat
console.log(obj2.name); //pig
obj1.show(); //cat
obj2.show(); //å‡½æ•°è¢«ä¸¢å¤±ï¼ŒæŠ¥é”™
```

> JSON.stringify()ä¼šå¯¼è‡´ä¸€ç³»åˆ—çš„é—®é¢˜ï¼Œå› ä¸ºè¦ä¸¥æ ¼éµå®ˆJSONåºåˆ—åŒ–è§„åˆ™ï¼šåŸå¯¹è±¡ä¸­å¦‚æœå«æœ‰**Dateå¯¹è±¡**ï¼ŒJSON.stringify()ä¼šå°†å…¶å˜ä¸ºå­—ç¬¦ä¸²ï¼Œä¹‹åå¹¶ä¸ä¼šå°†å…¶è¿˜åŸä¸ºæ—¥æœŸå¯¹è±¡ã€‚æˆ–æ˜¯å«æœ‰RegExpå¯¹è±¡ï¼ŒJSON.stringify()ä¼šå°†å…¶å˜ä¸ºç©ºå¯¹è±¡ï¼Œå±æ€§ä¸­å«æœ‰NaNã€Infinityå’Œ-Infinityï¼Œåˆ™åºåˆ—åŒ–çš„ç»“æœä¼šå˜æˆnullï¼Œå¦‚æœå±æ€§ä¸­**æœ‰å‡½æ•°**,undefined,symbolåˆ™ç»è¿‡JSON.stringify()åºåˆ—åŒ–åçš„JSONå­—ç¬¦ä¸²ä¸­**è¿™ä¸ªé”®å€¼å¯¹ä¼šæ¶ˆå¤±**ï¼Œå› ä¸ºä¸æ”¯æŒã€‚

**æ–¹æ³•äºŒï¼š**å‡½æ•°åº“lodashçš„_.cloneDeepæ–¹æ³•

> lodashæ˜¯å‰ç«¯å¼€å‘å¸¸ç”¨çš„å·¥å…·åº“ï¼Œæ˜¯å¯¹å„ç§æ–¹æ³•ã€å‡½æ•°çš„å°è£…ï¼Œé¡¹ç›®ä¸­ç›´æ¥å®‰è£…ä¾èµ–åŒ…ï¼Œå¼•å…¥å¹¶ä½¿ç”¨é‡Œé¢çš„å‡½æ•°ï¼Œå¸¸ç”¨å‡½æ•°ä¸­å°±æœ‰`_.cloneDeep (value)`æ·±æ‹·è´å‡½æ•°

```js
var _ = require('lodash');
var obj1 = {
    a: 1,
    b: { f: { g: 1 } },
    c: [1, 2, 3]
};
var obj2 = _.cloneDeep(obj1);
console.log(obj1.b.f === obj2.b.f);// false
```

**ğŸ’æ–¹æ³•ä¸‰ï¼š**æ‰‹å†™æ·±æ‹·è´

> è¿›ä¸€æ­¥å¯¹æµ…æ‹·è´çš„è®¤è¯†ï¼š
>
> 1. æ˜ç™½æµ…æ‹·è´çš„å±€é™æ€§: åªèƒ½æ‹·è´ä¸€å±‚å¯¹è±¡ã€‚ å¦‚æœå­˜åœ¨å¯¹è±¡çš„åµŒå¥—, é‚£ä¹ˆæµ…æ‹·è´å°†æ— èƒ½ä¸ºåŠ›
> 2. å¯¹äºåŸºç¡€æ•°æ®ç±»å‹åšä¸€ä¸ªæœ€åŸºæœ¬çš„æ‹·è´
> 3. å¯¹å¼•ç”¨ç±»å‹å¼€è¾Ÿä¸€ä¸ªæ–°çš„å­˜å‚¨, å¹¶æ‹·è´ä¸€å±‚å¯¹è±¡å±æ€§ï¼Œç¬¬äºŒå±‚åªæ‹·è´å¼•ç”¨åœ°å€

- è§£å†³å¾ªç¯å¼•ç”¨é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥é¢å¤–ç”¨ä¸€ä¸ªå­˜å‚¨ç©ºé—´Mapï¼Œæ¥å­˜å‚¨å½“å‰å¯¹è±¡å’Œæ‹·è´å¯¹è±¡çš„å¯¹åº”å…³ç³»ï¼Œå½“éœ€è¦æ‹·è´å½“å‰å¯¹è±¡æ—¶ï¼Œå…ˆå»å­˜å‚¨ç©ºé—´ä¸­æ‰¾ï¼Œæœ‰æ²¡æœ‰æ‹·è´è¿‡è¿™ä¸ªå¯¹è±¡ï¼Œå¦‚æœæœ‰çš„è¯ç›´æ¥è¿”å›ï¼Œå¦‚æœæ²¡æœ‰çš„è¯ç»§ç»­æ‹·è´ï¼Œè¿™æ ·å°±å¯ä»¥è§£å†³çš„å¾ªç¯å¼•ç”¨çš„é—®é¢˜ã€‚
- è¿™ä¸ªå­˜å‚¨ç©ºé—´ï¼Œéœ€è¦å¯ä»¥å­˜å‚¨ key-value å½¢å¼çš„æ•°æ®ï¼Œä¸” key å¯ä»¥æ˜¯ä¸€ä¸ªå¼•ç”¨ç±»å‹ï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹© Map è¿™ç§æ•°æ®ç»“æ„ï¼šæ£€æŸ¥ map ä¸­æœ‰æ— å…‹éš†è¿‡çš„å¯¹è±¡,å¦‚æœæœ‰åˆ™ç›´æ¥è¿”å›ï¼Œå¦‚æœæ²¡æœ‰åˆ™å°†å½“å‰å¯¹è±¡ä½œä¸º keyï¼Œå…‹éš†å¯¹è±¡ä½œä¸º value è¿›è¡Œå­˜å‚¨ï¼Œç»§ç»­å…‹éš†
- å¯ä»¥ä½¿ç”¨ WeakMap è¿›ä¸€æ­¥ä¼˜åŒ–ã€‚WeakMap å¯¹è±¡æ˜¯ä¸€ç»„é”®/å€¼å¯¹çš„é›†åˆï¼Œå…¶ä¸­çš„é”®æ˜¯å¼±å¼•ç”¨çš„ã€‚å…¶é”®å¿…é¡»æ˜¯å¯¹è±¡ï¼Œè€Œå€¼å¯ä»¥æ˜¯ä»»æ„çš„ã€‚
- æˆ‘ä»¬é»˜è®¤åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼šconst obj = {}ï¼Œå°±é»˜è®¤åˆ›å»ºäº†ä¸€ä¸ªå¼ºå¼•ç”¨çš„å¯¹è±¡ï¼Œæˆ‘ä»¬åªæœ‰æ‰‹åŠ¨å°† obj = nullï¼Œå®ƒæ‰ä¼šè¢«åƒåœ¾å›æ”¶æœºåˆ¶è¿›è¡Œå›æ”¶ï¼Œå¦‚æœæ˜¯å¼±å¼•ç”¨å¯¹è±¡ï¼Œåƒåœ¾å›æ”¶æœºåˆ¶ä¼šè‡ªåŠ¨å¸®æˆ‘ä»¬å›æ”¶ã€‚

```js
//æ–¹æ³•ä¸‰ï¼šæ‰‹å†™æ·±æ‹·è´
// ä¸Mapä¸åŒï¼ŒWeakMapçš„é”®keyåªèƒ½æ˜¯objectç±»å‹  keyä¸èƒ½è¢«éå†(å¼±å¼•ç”¨)ï¼Œä¸ä½¿ç”¨äº†å¯ä»¥è¢«åƒåœ¾å›æ”¶æœºåˆ¶å¤„ç†ï¼Œé‡Šæ”¾å†…å­˜ï¼Œè€ŒMapä¸ç”¨äº†jsè¿˜æ˜¯ä¼šä¿æŒæ¯ä¸ªkeyå’Œvalueçš„å¼•ç”¨(å¼ºå¼•ç”¨)ã€‚
// ä½¿ç”¨WeakMapæ¥è§£å†³å¾ªç¯å¼•ç”¨é—®é¢˜
function deepClone(target, map = new WeakMap()) {
    if(target instanceof RegExp) return new RegExp(target)// å¦‚æœæ˜¯æ­£åˆ™å¯¹è±¡ç›´æ¥newå¹¶è¿”å›ï¼Œä¼ å…¥å¯¹è±¡å®ä¾‹
    if(target instanceof Date) return new Date(target)// å¦‚æœæ˜¯æ—¥æœŸå¯¹è±¡ç›´æ¥newå¹¶è¿”å›
    if(typeof target === 'object' && target !== null && target !== undefined){
        if(map.get(target)) return cache// æ·±æ‹·è´é€’å½’ä¹‹å‰ï¼Œåˆ¤æ–­WeakMapä¸­çš„keyå­˜åœ¨ï¼Œåˆ™è¯æ˜ä¹‹å‰å·²ç»æ‹·è´è¿‡è¯¥å¯¹è±¡ï¼Œæœ‰æ‹·è´è¿‡ç›´æ¥è¿”å›
        const result = new target.constructor// ä½¿ç”¨å¯¹è±¡å®ä¾‹targetçš„æ„é€ æ–¹æ³•åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡
        map.set(target, result)// ä½¿ç”¨WeakMapæ¥å­˜å‚¨å¯¹è±¡å¯¹åº”å…³ç³»ï¼Œkeyå’Œvalueéƒ½æ˜¯å¯¹è±¡ï¼Œä»¥ä¾¿ä¹‹ååˆ¤æ–­å¯¹è±¡æ˜¯å¦è¢«æ‹·è´è¿‡
        if(Array.isArray(target)){// åˆ¤æ–­å¯¹è±¡targetæ˜¯å¦æ˜¯æ•°ç»„
            target.forEach((item, index) =>{// ä½¿ç”¨forEachè¿›è¡Œéå†ï¼Œå¹¶å¯¹æ¯ä¸€å±‚è¿›è¡Œæ·±æ‹·è´
                result[index] = deepClone(item, map)
            })
        } else {
            Object.keys(target).forEach(key => {
                result[key] = deepClone(target[key], map)
            })
        }
        return result
    } else {// å¦‚æœæ˜¯åŸºæœ¬ç±»å‹æˆ–è€…null undefined ç›´æ¥è¿”å›
        return target
    }
}
let obj5 = deepClone(obj3);
console.log(obj5)// { a: 1, b: { f: { g: 1 } }, c: [ 1, 2, 3 ] }
```



### 11.æ‰‹å†™æ•°ç»„æ‰å¹³åŒ–

#### 	11.1 é€’å½’å®ç°

> ä¸€é¡¹ä¸€é¡¹éå†ï¼Œå¦‚æœæŸä¸€é¡¹æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œåˆ™ç»§ç»­é€’å½’å¾€ä¸‹éå†ï¼Œç›´åˆ°å½“å‰é¡¹ä¸ºä¸€ä¸ªæ•°å†æ·»åŠ è¿›æ•°ç»„

```js
// æ–¹æ³•ä¸€ï¼š é€’å½’å®ç°
let arr = [1, [2, [3, 4, 5]]];
function flatten(arr) {
    let res = [];// å®šä¹‰ä¸€ä¸ªæ•°ç»„å­˜å‚¨ç»“æœ
    for (let i = 0; i < arr.length; i++) {//éå†æ•°ç»„
        if (Array.isArray(arr[i])) {// å¦‚æœå½“å‰æ•°ç»„å…ƒç´ æ˜¯ä¸€ä¸ªæ•°ç»„ åˆ™è¿›å…¥é€’å½’è°ƒç”¨--ã€‹æ‰å¹³åŒ–
            res = res.concat(flatten(arr[i]));// æ¯ä¸€å±‚æ‰å¹³åŒ–éƒ½ä¼šè¿”å›ä¸€ä¸ªæ•°ç»„ å’Œä¸Šä¸€å±‚çš„æ•°ç»„resä½œä¸€ä¸ªæ‹¼æ¥ 
        } else {
            res.push(arr[i]);// éæ•°ç»„åˆ™ç›´æ¥æ·»åŠ åˆ°resä¸­
        }
    }
    return res;
}
console.log(flatten(arr)); //  [1, 2, 3, 4ï¼Œ5]
```

#### 	11.2 ES6ä¸­çš„flat([depth])æ–¹æ³•

> flat()æ–¹æ³•ä¼šæŒ‰ç…§ä¸€ä¸ªå¯æŒ‡å®šçš„æ·±åº¦é€’å½’éå†æ•°ç»„ï¼Œå¹¶å°†æ‰€æœ‰å…ƒç´ ä¸éå†åˆ°çš„å­æ•°ç»„ä¸­çš„å…ƒç´ åˆå¹¶ä¸ºä¸€ä¸ªæ–°æ•°ç»„è¿”å›ï¼Œdepthæ˜¯æ•°ç»„å±•å¼€æ·±åº¦ã€‚

```js
function flatten(arr) {
    return arr.flat(Infinity);// æ•°ç»„çš„åµŒå¥—å±‚æ•°ä¸ç¡®å®šï¼Œæœ€å¥½ç›´æ¥ä½¿ç”¨ Infinity
}
```

#### 	11.3 æ•°ç»„çš„å½’å¹¶æ–¹æ³• reduce

> reduceæ–¹æ³•æ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªæ˜¯æ¯ä¸€é¡¹éƒ½ä¼šè¿è¡Œçš„å½’å¹¶å‡½æ•°(å›è°ƒå‡½æ•°)reducerï¼Œç¬¬äºŒé¡¹æ˜¯å½’å¹¶èµ·ç‚¹çš„åˆå§‹å€¼ï¼Œä¼ è¿›reduceä¸­çš„å›è°ƒå‡½æ•°æ¥æ”¶å››ä¸ªå‚æ•°ï¼Œ1ï¼šä¸Šä¸€ä¸ªå½’å¹¶å€¼(å‡½æ•°è¿”å›å€¼)preï¼Œ2ï¼šå½“å‰é¡¹curï¼Œ3ï¼šå½“å‰é¡¹ç´¢å¼•å€¼indexï¼Œ4ï¼šæ•°ç»„æœ¬èº«arrï¼Œä¸€èˆ¬åªç”¨åˆ°å‰é¢ä¸¤ä¸ªã€‚å¦‚æœreduceæ²¡æœ‰ä¼ å…¥å¯é€‰çš„ç¬¬äºŒä¸ªå‚æ•°ï¼Œåˆ™ç¬¬ä¸€æ¬¡è¿­ä»£ä»æ•°ç»„çš„ç¬¬äºŒé¡¹ï¼ˆå½“å‰é¡¹ï¼‰å¼€å§‹ï¼Œpreä¸ºç¬¬äºŒé¡¹ï¼Œä¾‹å¦‚æ±‚å’Œã€‚å¦‚æœä¼ å…¥äº†å‚æ•°ï¼Œåƒä¸‹é¢ä¼ å…¥äº†[]ç©ºæ•°ç»„ï¼Œåˆ™ä¼ ç»™å›è°ƒå‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°preæ˜¯[]ç©ºæ•°ç»„

```js
function flatten(arr) {
    return arr.reduce((pre, next) => {
        return pre.concat(Array.isArray(next) ? flatten(next) : next)
    }, [])// ç¬¬äºŒä¸ªå‚æ•°[]ç©ºæ•°ç»„ä½œä¸ºåˆå§‹å€¼pre
}
```

#### 	11.4 æ‰©å±•è¿ç®—ç¬¦

#### 	11.5 æ­£åˆ™

### 12.æ‰‹å†™æ•°ç»„å»é‡

#### 	12.1 ä½¿ç”¨Seté›†åˆ

```js
// æ–¹æ³•ä¸€ï¼šä½¿ç”¨Seté›†åˆ
let arr = [1, 2, 3, 5, 1, 5, 9, 1, 2, 8];
// Array.from() æ–¹æ³•å¯¹ä¸€ä¸ªç±»ä¼¼æ•°ç»„æˆ–å¯è¿­ä»£å¯¹è±¡åˆ›å»ºä¸€ä¸ªæ–°çš„ï¼Œæµ…æ‹·è´çš„æ•°ç»„å®ä¾‹ã€‚
let res = Array.from(new Set(arr));
console.log(res);// [ 1, 2, 3, 5, 9, 8 ]
```

#### 	12.2 forå¾ªç¯

```js
// æ–¹æ³•äºŒï¼šforå¾ªç¯ 
function removeDuplicates(arr) {
    let map = {};// å®šä¹‰ä¸ªmapå¯¹è±¡,ä½¿ç”¨mapå­˜å‚¨ä¸é‡å¤çš„æ•°å­—
    let res = [];// å®šä¹‰æ•°ç»„ä¿å­˜ç»“æœ
    for (let i = 0; i < arr.length; i++) {// éå†æ•°ç»„
        if (!map.hasOwnProperty([arr[i]])) {// åˆ¤æ–­mapå¯¹è±¡è‡ªèº«æ˜¯å¦æœ‰arr[i]å±æ€§
            map[arr[i]] = 1;// æ²¡æœ‰çš„è¯ å°±æŠŠarr[i]ä½œä¸ºå±æ€§ 1ä¸ºå€¼æ·»åŠ åˆ°å¯¹è±¡ä¸­
            res.push(arr[i]);// å› ä¸ºæ²¡æœ‰mapä¸­æ²¡æœ‰arr[i] æ‰€ä»¥arr[i]ä¸æ˜¯é‡å¤é¡¹ åˆ™æ·»åŠ è¿›resæ•°ç»„ä¸­
        }
    }
    return res;// è¿”å›res
}
let a = removeDuplicates(arr);
console.log(a);// [ 1, 2, 3, 5, 9, 8 ]
```

### 13.æ‰‹å†™æ•°ç»„çš„flatæ–¹æ³•

```js
// flat()æ–¹æ³•ä¼šæŒ‰ç…§ä¸€ä¸ªå¯æŒ‡å®šçš„æ·±åº¦é€’å½’éå†æ•°ç»„ï¼Œå¹¶å°†æ‰€æœ‰å…ƒç´ ä¸éå†åˆ°çš„å­æ•°ç»„ä¸­çš„å…ƒç´ åˆå¹¶ä¸ºä¸€ä¸ªæ–°æ•°ç»„è¿”å›
// flat()æ–¹æ³• ä¼ å…¥æ•°ç»„å’Œdepthæ•°ç»„æ·±åº¦
let arr = [1, [2, [3, 4, 5]]];
function _flat(arr, depth) {
    if (!Array.isArray(arr) || depth <= 0) {
        return arr;// å¦‚æœarrä¸æ˜¯æ•°ç»„ æˆ–è€… ä¼ å…¥depthæ·±åº¦ä¸ºå°äº0 åˆ™ç›´æ¥è¿”å›arr
    }
    return arr.reduce((pre, next) => {
        return pre.concat(Array.isArray(next) ? _flat(next) : next)
    }, [])
}
//æµ‹è¯•
let res = _flat(arr, 3);
console.log(res);
```

### 14.æ ‘çŠ¶ç»“æ„çš„é€’å½’éå†

```js
let dt = [{
    id: '2',
    title: 'æµ™æ±Ÿçœ',
    children: [{
        id: '2-1',
        title: 'æ­å·å¸‚',
            children: [{
                id: '2-1-2',
                title: 'adåŒº',
                children: [{
                    id: '2-1-1-1',
                    children: []
                }]
            }],
            children: [{
                id: '2-1-1',
                title: 'æ»¨æ±ŸåŒº',
                children: [{
                    id: '2-1-1-1',
                    children: []
                }]
            }]
        },
        {
            id: '2-2',
            children: [{
                id: '2-2-1',
                children: [{
                    id: '2-2-1-1',
                    children: []
                }]
            }]
        }
    ]
}]

//æŸ¥æ‰¾æ‰€æœ‰ä¸Šçº§æ–¹æ³•
function treeFindPath (tree, path = []) {
  if (!tree) return []
  for (const data of tree) {
    // è¿™é‡ŒæŒ‰ç…§ä½ çš„éœ€æ±‚æ¥å­˜æ”¾æœ€åè¿”å›çš„å†…å®¹å§
    path.push(data.title)
    // æ»¡è¶³æ¡ä»¶è¿”å›path
    if (data.id=='2-1-1') return path
    if (data.children) {
      // è¿”å›çš„pathæ„å‘³ç€æ‰¾åˆ°äº†
      const findChildren = treeFindPath(data.children, [...path])
      // é€’å½’è¿”å›
      if (findChildren.length) return findChildren
    }
    path.pop()
  }
  return []
}
//è°ƒç”¨
let arr = treeFindPath(dt)
console.log('/'+arr.join('/'))  // /æµ™æ±Ÿçœ/æ­å·å¸‚/æ»¨æ±ŸåŒº
```



## äºŒã€è®¾è®¡æ¨¡å¼

### å‘å¸ƒè®¢é˜…æ¨¡å¼å’Œè§‚å¯Ÿè€…æ¨¡å¼çš„åŒºåˆ«

ä¸¤è€…æ‰€éœ€è¦çš„è§’è‰²æ•°é‡ä¸ä¸€æ ·ï¼Œè§‚å¯Ÿè€…æ¨¡å¼éœ€è¦ä¸¤ä¸ªè§’è‰²(è§‚å¯Ÿè€…å’Œæ¶ˆè´¹è€…)ä¾¿å¯æˆå‹ï¼Œå‘å¸ƒè®¢é˜…éœ€è¦ä¸‰ä¸ªè§’è‰²(å‘å¸ƒè€…ï¼Œè®¢é˜…è€…ï¼Œç¬¬ä¸‰æ–¹å‘å¸ƒè®¢é˜…ä¸­å¿ƒ)ã€‚ä¸åŒåº”ç”¨åœºæ™¯çš„è®¾è®¡æ¨¡å¼å®ç°æ–¹æ³•ä¸å°½ç›¸åŒã€‚

<img src="../images/image-20220601141406185.png" alt="image-20220601141406185" style="zoom: 67%;" />

### 1.æ‰‹å†™äº‹ä»¶è®¢é˜…å‘å¸ƒæ¨¡å¼(è®¾è®¡æ¨¡å¼)

> å¯¹è±¡é—´ä¸€ç§ä¸€å¯¹å¤šçš„ä¾èµ–å…³ç³»ï¼Œå½“ç›®æ ‡å¯¹è±¡æŒ‡å®šçš„åŠ¨ä½œå‘ç”Ÿæ”¹å˜æ—¶ï¼Œè®¢é˜…è¯¥åŠ¨ä½œçš„ä¾èµ–å¯¹è±¡ä¼šæ”¶åˆ°ç›¸åº”çš„é€šçŸ¥ã€‚è®¢é˜…è€…åœ¨å‘å¸ƒè®¢é˜…ä¸­å¿ƒEventSubPubè®¢é˜…/æ³¨å†Œäº‹ä»¶å’Œå›è°ƒå‡½æ•°ï¼Œå‘å¸ƒè€…é€šè¿‡ä¸­å¿ƒå‘å¸ƒ/è§¦å‘æŸä¸€äº‹ä»¶ï¼Œä¼šè°ƒç”¨å›è°ƒå‡½æ•°é€šçŸ¥è®¢é˜…/æ³¨å†Œè¯¥äº‹ä»¶çš„äºº

```js
// ç”¨ES6çš„æ–¹å¼æ¥å†™
class EventSubPub {
    constructor() {
        this.events = {};// å®šä¹‰ä¸€ä¸ªäº‹ä»¶å¯¹è±¡ï¼Œå­˜å‚¨è®¢é˜…äº‹ä»¶å’Œå›è°ƒå‡½æ•°(æ–¹æ³•)
        // å¦‚ï¼š {click : [handler1, handler2, ...], sleep : [handler1, handler2]...} æ¯ä¸€ä¸ªäº‹ä»¶æœ‰å„ç§æ–¹æ³•,å½¢æˆæ–¹æ³•æ•°ç»„
    }
    // è®¢é˜…äº‹ä»¶/æ³¨å†Œäº‹ä»¶ä»¥åŠäº‹ä»¶çš„å›è°ƒå‡½æ•°
    on(eventName, handler) {// å‚æ•°ä¸ºå‚æ•°åå’Œå›è°ƒå‡½æ•°(å°±æ˜¯è§¦å‘è¯¥äº‹ä»¶ä¼šæ‰§è¡ŒæŸäº›æ–¹æ³•)ï¼Œè¿™äº›æ–¹æ³•å¯ä»¥æ˜¯å¤šä¸ª
        if (!this.events[eventName]) {// å¦‚æœæœ¬æ¥æ²¡æœ‰æ³¨å†Œäº‹ä»¶
            this.events[eventName] = [handler]// åˆ™åˆ›å»ºæ•°ç»„å¹¶æ·»åŠ ç¬¬ä¸€ä¸ªå›è°ƒå‡½æ•°
        } else {
            this.events[eventName].push(handler);// å¦‚æœæœ¬æ¥æ³¨å†Œè¿‡äº‹ä»¶ï¼Œåˆ™å­˜å…¥æ¥ä¸‹æ¥çš„å›è°ƒå‡½æ•°
            // this.event[eventName] è¿™æ˜¯ä¸€ä¸ªæ•°ç»„ æ˜¯ä¸Šé¢æ‰€åˆ›å»ºçš„
        }
    }
    // å‘å¸ƒäº‹ä»¶/è§¦å‘äº‹ä»¶å›è°ƒ å‚æ•°ï¼šäº‹ä»¶åå’Œäº‹ä»¶å›è°ƒå‡½æ•°å‚æ•°
    emit(eventName, args) {// éœ€è¦ä¼ å…¥äº‹ä»¶åå’Œå‚æ•°
        if (!this.events[eventName]) {// äº‹ä»¶æœªæ³¨å†Œ ç›´æ¥æŠ›å‡ºé”™è¯¯
            return new Error('è¯¥äº‹ä»¶æœªæ³¨å†Œ')
        }
        // éå†å¯¹åº”äº‹ä»¶é‡Œæ•°ç»„ä¸­çš„æ–¹æ³•(å›è°ƒå‡½æ•°) å¹¶ æ‰§è¡Œæ‰€æœ‰å›è°ƒå‡½æ•°(éœ€è¦ä¼ å…¥å‚æ•°)
        this.events[eventName].forEach(handler => { handler(args) })
    }
    // äº‹ä»¶ç§»é™¤ å‚æ•° äº‹ä»¶åå’Œå›è°ƒå‡½æ•°
    off(eventName, handler) {
        if(this.events[eventName]) {// åˆ¤æ–­æ˜¯å¦æ³¨å†Œè¿‡è¯¥äº‹ä»¶
            if(!handler) {// åˆ¤æ–­æ˜¯å¦ä¼ å…¥äº†äº‹ä»¶å¯¹åº”çš„å›è°ƒå‡½æ•°
              delete this.events[eventName];// æ²¡æœ‰ä¼ å…¥ç›´æ¥åˆ é™¤äº‹ä»¶
            } else {
                let index = this.events[eventName].indexOf(handler);// åœ¨æ•°ç»„ä¸­æ‰¾åˆ°ç¬¬ä¸€ä¸ªå‡ºç°è¯¥å›è°ƒå‡½æ•°handlerçš„ä¸‹æ ‡
                this.events[eventName].splice(index, 1);// 
                // slice å¯ä»¥ä¼ å…¥ä¸¤ä¸ªå‚æ•° è‹¥åªä¼ å…¥ä¸€ä¸ª åˆ™è¿”å›è¯¥ç´¢å¼•åˆ°æ•°ç»„æœ«å°¾æ‰€æœ‰å…ƒç´ ï¼Œè‹¥ä¼ å…¥ä¸¤ä¸ª(a,b) åˆ™åˆ‡å‰²ç´¢å¼•aåˆ°b ä¸åŒ…æ‹¬bçš„æ•°ç»„å…ƒç´ (å·¦é—­å³å¼€)
                // spliceå¯ä»¥ä¼ å…¥ä¸‰ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªä¸ºå¼€å§‹ä½ç½®ï¼Œç¬¬äºŒä¸ªä¸ºåˆ é™¤ä¸ªæ•°ï¼Œç¬¬ä¸‰ä¸ª(è¿˜å¯ä»¥ä»»æ„å¤šä¸ª)ä¸ºæ’å…¥å…ƒç´ 
            }
        }
    }
}
// æµ‹è¯•
const events = new EventSubPub()
function fn1() {
    console.log("fn1");
}
function fn2() {
    console.log("fn2");
}
function fn3() {
    console.log("fn3 ");
}
events.on("event1", fn1)
events.on("event1", fn2)
events.on("event2", fn2)
events.on("event3", fn3)// æ³¨å†Œäº‹ä»¶å’Œå›è°ƒå‡½æ•°
events.emit("event1")// fn1 fn2
events.off("event1", fn1);// å…³é—­è®¢é˜… ç§»é™¤äº‹ä»¶åŠå¯¹åº”çš„å›è°ƒå‡½æ•°
events.emit("event1")// fn2
events.emit("event2")// fn2
events.emit("event3")// fn3
events.off("event2")// å…³é—­ã€ç§»é™¤æ•´ä¸ªäº‹ä»¶event2
events.off("event3")// å…³é—­ã€ç§»é™¤æ•´ä¸ªäº‹ä»¶event3
events.emit("event2")// æ— 
events.emit("event3")// æ— 
```

### 2.æ‰‹å†™è§‚å¯Ÿè€…æ¨¡å¼

> å¯¹è±¡é—´ä¸€ç§ä¸€å¯¹å¤šçš„ä¾èµ–å…³ç³»ï¼Œå½“ç›®æ ‡å¯¹è±¡ Subject çš„çŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶ï¼Œæ‰€æœ‰ä¾èµ–å®ƒçš„å¯¹è±¡ Observer éƒ½ä¼šå¾—åˆ°é€šçŸ¥ã€‚è¢«è§‚å¯Ÿè€…Subjectå°†è§‚å¯Ÿè€…æ·»åŠ åˆ°è‡ªå·±çš„è§‚å¯Ÿè€…åˆ—è¡¨ï¼Œ

```js
// Subject è¢«è§‚å¯Ÿå¯¹è±¡
function Subject() {
    this.observers = [];// åˆ›å»ºæ•°ç»„ç”¨äºå­˜å‚¨è§‚å¯Ÿè€…
}
Subject.prototype = {// åœ¨è¢«è§‚å¯Ÿè€…çš„åŸå‹ä¸Šæ·»åŠ æ–¹æ³•
    add(observer) {  // æ·»åŠ è§‚å¯Ÿè€…
        this.observers.push(observer);
    },
    notify() {  // æ·»åŠ é€šçŸ¥æ–¹æ³•
        var observers = this.observers;// è·å–æ‰€ç”¨æ·»åŠ è¿›æ¥çš„è§‚å¯Ÿè€…
        for (var i = 0; i < observers.length; i++) {// éå†è°ƒç”¨è§‚å¯Ÿè€…çš„æ›´æ–°æ–¹æ³• é€šçŸ¥è§‚å¯Ÿè€…ä»¬æ›´æ–°
            observers[i].update();
        }
    },
    remove(observer) {  // åˆ é™¤è§‚å¯Ÿè€…
        var observers = this.observers;
        for (var i = 0; i < observers.length; i++) {// éå†æ‰€æœ‰è§‚å¯Ÿè€…
            if (observers[i] === observer) {// å¦‚æœå½“å‰è§‚å¯Ÿè€…å’Œä¼ è¿›æ¥çš„ä¸€æ ·
                observers.splice(i, 1);// åˆ™åˆ é™¤ä¼ è¿›æ¥çš„è§‚å¯Ÿè€…
            }
        }
    },
}
// Observer è§‚å¯Ÿè€…å¯¹è±¡
function Observer(name) {
    this.name = name;
}
Observer.prototype = {// åœ¨è§‚å¯Ÿè€…çš„åŸå‹ä¸Šæ·»åŠ æ›´æ–°æ–¹æ³•
    update() {  // æ›´æ–°
        console.log('my name is ' + this.name);
    }
}
var sub = new Subject();
var obs1 = new Observer('guang1');
var obs2 = new Observer('guang2');
sub.add(obs1);
sub.add(obs2);
// é€šçŸ¥æ‰€æœ‰è§‚å¯Ÿè€…
sub.notify();  //my name is guang1 my name is guang2
```

